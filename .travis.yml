language: python
python:
  - "3.6.7"

before_install:
  - sudo apt-get -qq update
  - sudo apt-get install -y libomp-dev
  - pushd script
  - sudo ./get_mpich.sh
  - popd

compiler:
  - gcc

install:
  - pip install -r requirements.txt

script:
  - make units-check
  - make check -B 
  - python3 -m pytest .
  - make check -B WITH_MPI=2
  - make check -B WITH_OMP=2
  - make check -B WITH_OMP=1 WITH_MPI=2
  - make check -B WITH_OMP=2 WITH_MPI=1
